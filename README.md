# üßæ Filesure ADT-1 Assignment

This project automates the extraction and summarization of information from Form ADT-1 PDFs, including their attachments. The workflow uses OCR and LLMs (OpenAI) to overcome limitations in scanned or poorly formatted PDFs. The process is now fully reproducible and version-controlled using **DVC**.

---

## üìÅ Project Structure

```
filesure-adt1-assignment/
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ attachments/               # Extracted PDF attachments (from the main ADT-1 PDF)
‚îÇ   ‚îú‚îÄ‚îÄ processed/                 # Final structured output (e.g. JSON file)
‚îÇ   ‚îú‚îÄ‚îÄ raw/                       # Input PDF (Form ADT-1)
                   
‚îî‚îÄ‚îÄ reports/                   # Markdown/text summaries generated by LLM
‚îÇ   ‚îú‚îÄ‚îÄ attachments_file_summary.md
    ‚îú‚îÄ‚îÄ summary.txt

‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ extractor.py               # Extracts structured data from the main ADT-1 PDF using OCR
‚îÇ   ‚îú‚îÄ‚îÄ summary_generator.py       # Generates a human-readable summary from the extracted data
‚îÇ   ‚îú‚îÄ‚îÄ attachment_parser.py       # Extracts embedded attachments from the main ADT-1 PDF
‚îÇ   ‚îî‚îÄ‚îÄ attachment_files_summary.py # Summarizes each extracted attachment using OpenAI
‚îÇ
‚îú‚îÄ‚îÄ .dvcignore          # Files to ignore during DVC tracking
‚îú‚îÄ‚îÄ .gitignore          # Files to ignore during Git tracking
‚îú‚îÄ‚îÄ requirements.txt    # Python dependencies
‚îú‚îÄ‚îÄ dvc.yaml            # DVC pipeline definition
‚îú‚îÄ‚îÄ dvc.lock            # DVC pipeline lock file
‚îú‚îÄ‚îÄ errors.log          # Logs errors during pipeline execution
‚îú‚îÄ‚îÄ README.md           # Project instructions and overview
‚îÇ
‚îî‚îÄ‚îÄ .env                           # My OpenAI API key (not shared)
```



---

## ‚öôÔ∏è Workflow Overview (via DVC)

### üîπ 1. **Extract Embedded Attachments**
**File:** `src/attachment_parser.py`

- Scans the original ADT-1 PDF (`data/raw/Form ADT-1-29092023_signed.pdf`) for embedded files.
- Extracts and saves each embedded attachment into: `data/attachments/`

---

### üîπ 2. **Extract Main Data from ADT-1 PDF**
**File:** `src/extractor.py`

- Converts the main ADT-1 PDF into images using `pdf2image`, then performs OCR using `pytesseract`.
- Extracts structured data fields using regular expressions.
- Output is saved as: `data/processed/output.json`

---

### üîπ 3. **Generate Summary of Main ADT-1 Form**
**File:** `src/summary_generator.py`

- Reads the structured data from `data/processed/output.json`.
- Sends the information to OpenAI GPT-4o to generate a readable, formal summary.
- Output summary saved at: `reports/summary.txt`

---

### üîπ 4. **Summarize Each Extracted Attachment**
**File:** `src/attachment_files_summary.py`

- Loops through each file in `data/attachments/`, applies OCR, and summarizes the content using OpenAI.
- All summaries are saved together in: `reports/attachments_file_summary.md`

---

## üõ† How to Run the Project

## Step 1: üß∞ OCR Setup (Tesseract Installation Required)

This project relies on **Tesseract OCR** to extract text from scanned PDF documents using Optical Character Recognition (OCR). You **must install** Tesseract and ensure it's available via your system‚Äôs environment variable (`PATH`) before running the pipeline.

---

### ‚úÖ Step-by-Step Setup (Windows)

#### 1. Download and Install Tesseract

- Go to the following link and download the latest `.exe` installer for Windows:  
  üëâ https://github.com/UB-Mannheim/tesseract/wiki

- Run the installer and follow the default installation steps.

> üìç By default, Tesseract installs to:  
> `C:\Program Files\Tesseract-OCR`

---

#### 2. Add Tesseract to System PATH (Using PowerShell)

To make `tesseract` accessible from anywhere, you need to add it to your system‚Äôs environment variable (`PATH`).

Open **PowerShell as Administrator** and run the following command:

```powershell
[Environment]::SetEnvironmentVariable("Path", $env:Path + ";C:\Program Files\Tesseract-OCR", [EnvironmentVariableTarget]::Machine)
```

> ‚ö†Ô∏è Replace the path if you installed Tesseract in a different location.

---

#### 3. Restart Your Terminal

To apply the changes, **close and reopen** your terminal (PowerShell, CMD, or VS Code).

---

#### 4. Verify Installation

Run this command to ensure Tesseract was correctly installed and added to your `PATH`:

```powershell
tesseract --version
```

You should see output similar to:

```
tesseract v5.x.x
leptonica-1.8x.x
```

If the version prints successfully, you're all set!

---

### üìù Notes

- Tesseract is required by `extractor.py` and `attachment_files_summary.py` to perform OCR-based text extraction from PDF pages.
- This step only needs to be done once per machine setup.
- If you're using a virtual environment, no need to add Tesseract there‚Äîit‚Äôs a system-level binary.

---


### Step 2: Set Up Environment
Install dependencies:

```bash
pip install -r requirements.txt
```

### Step 3: Add Your OpenAI API Key
Create a `.env` file in the root directory:

```bash
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

### Step 4: Run the Full Pipeline with DVC

```bash
dvc repro
```

Or run individual steps manually if needed:

```bash
python src/attachment_parser.py
python src/extractor.py
python src/summary_generator.py
python src/attachment_files_summary.py
```

---

## üì¶ Output Files

- `data/processed/output.json` ‚Äì structured data from main PDF
- `reports/summary.txt` ‚Äì summary of the main ADT-1 form
- `reports/attachments_file_summary.md` ‚Äì summaries for all embedded PDFs

---

## üí° Notes

- OCR was chosen over direct PDF parsing because the scanned text had inconsistent structure using PyMuPDF.
- This pipeline provides clarity, automation, and auditability using **DVC**.
- The output is especially useful for legal, audit, and compliance documentation.

